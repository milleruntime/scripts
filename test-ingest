# usage: test-ingest [rows] - ingest 1000 or provided rows
ROWS=1000
COLS=10
if [[ -n "$1" ]]; then
  ROWS=$1
fi

# need test jar to be in lib
echo "Looking for test jar in $ACCUMULO_HOME/lib"
if compgen -G  "${ACCUMULO_HOME}/lib/accumulo-test-*.jar" > /dev/null; then
  echo "Test jar found"
else
  echo "Test jar is not in lib!"
  exit 1
fi

accumulo shell -e 'droptable test_ingest -f' -u root -p secret
accumulo shell -e 'createtable test_ingest' -u root -p secret
accumulo shell -e 'addsplits -t test_ingest row_0000000005 row_0000000055 row_0000000555' -u root -p secret
echo "Ingesting $ROWS rows"
accumulo org.apache.accumulo.test.TestIngest -c "$ACCUMULO_HOME/conf/accumulo-client.properties" -u root --rows "${ROWS}" --cols "${COLS}"
accumulo shell -e 'tables -l' -u root -p secret

echo "Other possible commands to run"
echo "accumulo shell -e 'flush -t test_ingest -w' -u root -p secret"
echo "accumulo shell -e 'compact -t test_ingest -w' -u root -p secret"
