#!/bin/bash
# usage: mvn-runIT <directory/IT> [number-of-runs]
# number-of-runs defaults to 1
RUNS=1

set -x #echo on
. $SCRIPTS_HOME/mvn/maven-opts
env | grep MAVEN

# if param is a directory get all ITs from that dir
if [ -d "$1" ]; then
   TEST=$(ls -p $1 | grep -v / | grep ".*IT.java" | tr '\n' ',')
else
   TEST=$1
fi
shift

MVN='mvn clean -Dit.test=$TEST -Dtest=foo -Dspotbugs.skip -Drat.skip -Dformatter.skip -Dcheckstyle.skip -Dmodernizer.skip -Dimpsort.skip -Dsortpom.skip -DfailIfNoTests=false "$@" verify -pl :accumulo-test'
i=0
while [[ $i < $RUNS ]]; do
   i=$(( i + 1))
   eval $MVN
done

